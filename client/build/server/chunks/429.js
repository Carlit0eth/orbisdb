"use strict";exports.id=429,exports.ids=[429],exports.modules={9239:(e,t,s)=>{s.d(t,{Co:()=>countSubContexts,GH:()=>PluginsCountTag,ZP:()=>ContextDetails,sB:()=>countPluginsByContext});var n=s(997),o=s(9894),l=s.n(o),a=s(6689),r=s(6640),i=s(3279);function ContextDetails({context:e}){return(0,n.jsxs)("div",{className:"flex flex-row bg-white px-4 py-3 border border-slate-200 rounded-md items-center",children:[e.logo&&n.jsx("img",{src:e.logo,alt:e.name,className:"h-14 w-14 flex-shrink-0 mr-3 rounded-md"}),(0,n.jsxs)("div",{className:"flex flex-col space-y-1",children:[n.jsx(l(),{className:"text-[#4483FD] font-medium text-base hover:underline",href:"/contexts/"+e.stream_id,children:e.name}),n.jsx(SubContextsCountTag,{context_id:e.stream_id})]})]})}let SubContextsCountTag=({context_id:e})=>(0,n.jsxs)("div",{className:"bg-slate-100 rounded-full px-3 py-1 text-xs font-medium text-slate-800 mr-1",children:[countSubContexts(e)," sub-context(s)"]}),PluginsCountTag=({context_id:e})=>(0,n.jsxs)("div",{className:"bg-slate-100 rounded-full px-3 py-1 text-xs font-medium text-slate-800",children:[countPluginsByContext(e)," plugin(s)"]}),countPluginsByContext=e=>{let{settings:t}=(0,a.useContext)(r.k),s=(0,i.d2)(e,t.plugins);return console.log("results:",s),s.direct.length+s.parent.length},countSubContexts=(e,t)=>{let s;let{settings:n}=(0,a.useContext)(r.k);s=t||n.contexts;let findContext=(e,t)=>{for(let s of t){if(s.stream_id===e)return s;if(s.contexts){let t=findContext(e,s.contexts);if(t)return t}}return null},o=findContext(e,s);if(!o||!o.contexts||0===o.contexts.length)return 0;let l=o.contexts.length;for(let e of o.contexts)l+=countSubContexts(e.stream_id,o.contexts);return l}},5620:(e,t,s)=>{s.d(t,{Z:()=>ContextSettings});var n=s(997),o=s(6689),l=s(7737),a=s(6640),r=s(3279);function ContextSettings({context:e,setContext:t,callback:s,parentContext:i}){let{orbis:x,settings:c,setSettings:u}=(0,o.useContext)(a.k),[d,m]=(0,o.useState)(r.Q_.ACTIVE),[g,f]=(0,o.useState)(e?.name?e.name:""),[p,C]=(0,o.useState)(e?.logo?e.logo:null),[h,b]=(0,o.useState)(e?.logo?e.logo:null),[j,S]=(0,o.useState)(e?.description?e.description:""),v=(0,o.useRef)(null);async function selectLogo(){v.current.click()}let uploadToServer=async n=>{let o;m(r.Q_.LOADING);let l={...e};if(console.log("Previous context:",l),l.name=g,l.description=j||null,console.log("New context:",l),i&&(l.context=i),e?o=await x.updateContext(e.stream_id,l):(o=await x.createContext(l),l.stream_id=o.doc),console.log("res:",o),200==o.status){let e=new FormData;e.append("file",h),e.append("context",JSON.stringify(l)),console.log("body:",e);let n=await fetch("/api/settings/add-context",{method:"POST",body:e}),o=await n.json();console.log("data:",o),200==o.status?(t&&t(o.context),u(o.settings),m(r.Q_.SUCCESS),await (0,r._v)(500),m(r.Q_.ACTIVE),s&&s()):m(r.Q_.ERROR)}else m(r.Q_.ERROR),alert("There was an error updating the Ceramic stream.")};return(0,n.jsxs)("div",{className:"flex flex-col",children:[n.jsx("input",{type:"text",placeholder:"Context name",className:"bg-white w-full mt-2 px-2 py-1 rounded-md border border-slate-300 text-base text-slate-900 mb-1.5",onChange:e=>f(e.target.value),value:g}),n.jsx("textarea",{type:"text",placeholder:"Context description",rows:"2",className:"bg-white w-full px-2 py-1 rounded-md border border-slate-300 text-base text-slate-900 mb-2",onChange:e=>S(e.target.value),value:j}),(0,n.jsxs)("div",{className:"flex flex-row items-center space-x-2 mb-2",children:[n.jsx("p",{className:"font-medium text-slate-900 text-base",children:"Logo:"}),p&&n.jsx("img",{src:p,className:"h-8 w-8 ml-2 rounded-md"}),n.jsx("input",{ref:v,type:"file",className:"hidden",accept:"image/png, image/jpeg, image/gif",onChange:e=>{if(e.target.files&&e.target.files[0]){let t=e.target.files[0];b(t),C(URL.createObjectURL(t))}}}),n.jsx(l.Z,{type:"secondary",onClick:()=>selectLogo(),title:"Upload logo"})]}),n.jsx("div",{className:"flex w-full justify-center mt-2",children:n.jsx(l.Z,{title:"Save",status:d,onClick:()=>uploadToServer()})})]})}}};